<!-- View component that includes the result of a single execution. -->

<template id="tmpl-result">
  <style>
    @import "bower_components/katex/dist/katex.min.css";
    * {
      padding: 0;
      margin: 0;
    }

    #state {
      display: block;
      margin-bottom: 5px;
    }

    h1 {
      font-size: 12pt;
      font-family: Helvetica;
      font-weight: normal;
      font-variant: small-caps;
      padding: 4px 20px;
      border-top-left-radius: 5px;
      border-top-right-radius: 5px;
      cursor: pointer;
    }

    h1 button {
      float: right;
      width: 30px;
      text-align: center;
      cursor: pointer;
    }

    .ok h1 {
      color: #7c7;
      background-color: #7f7;
    }

    .err h1 {
      color: #c00;
      background-color: #f77;
    }

    #output-container {
      padding: 5px 10px;
      border-left: solid 2px #eee;
      border-right: solid 2px #eee;
      border-bottom: solid 2px #eee;
      margin-bottom: 5px;
      font-family: monospace;
      font-weight: 110%;
    }

    .collapsed #output-container {
      display: none;
    }

    .collapsed h1 {
      border-radius: 5px;
    }
  </style>
  <div id="state">
    <h1>
      <button id="btn-close">X</button>
      <span id="label"></span>
    </h1>
    <div id="output-container"></div>
  </div>
</template>



<script>
(function () {
  var importDoc = document.currentScript.ownerDocument;

  var resultPrototype = Object.create(HTMLElement.prototype);

  resultPrototype.createdCallback = function() {
    var t = importDoc.querySelector('#tmpl-result');
    var node = document.importNode(t.content, true);
    this.root = this.createShadowRoot();
    this.root.appendChild(node);

    this.state = this.root.getElementById("state");
    this.outputContainer = this.root.getElementById("output-container");
    this.header = this.root.querySelectorAll("h1")[0];
    this.label = this.root.getElementById("label");
    this.closeButton = this.root.getElementById("btn-close");

    this.header.onclick = function () {
      this.state.classList.toggle("collapsed");
    }.bind(this);

    this.closeButton.onclick = function () {
      this.remove();
    }.bind(this);
  };

  resultPrototype.setKind = function (kind) {
    this.state.classList.add(kind);
  }

  resultPrototype.setLabel = function (content) {
    this.label.innerHTML = content;
  }

  resultPrototype.setPayload = function (content) {
    this.outputContainer.innerHTML = content;
  };

  document.registerElement('sidecar-result', {prototype: resultPrototype});
})();
</script>
